import React, { useState } from 'react';
import { Search, Bell, Menu, Sun, Moon, Settings, LogOut, User, LayoutDashboard, Store } from 'lucide-react';
import { useTheme } from '../context/ThemeContext';
import { useNavigate } from 'react-router-dom';
import {
    DropdownMenu,
    DropdownMenuContent,
    DropdownMenuItem,
    DropdownMenuLabel,
    DropdownMenuSeparator,
    DropdownMenuTrigger,
} from "../components/ui/dropdown-menu"

const Header = ({ onMenuClick }) => {
    const { theme, toggleTheme } = useTheme();
    const navigate = useNavigate();

    const notifications = [
        { id: 1, title: 'New appointment created: Fusionedge Test Hospital', time: 'Nov 19, 2025 19:18' },
        { id: 2, title: 'New appointment created: Fusionedge Test Hospital', time: 'Nov 18, 2025 23:40' },
        { id: 3, title: 'New appointment created: Fusionedge Test Hospital', time: 'Oct 28, 2025 17:25' },
        { id: 4, title: 'New appointment created: Fusionedge Test Hospital', time: 'Oct 6, 2025 23:07' },
        { id: 5, title: 'New appointment created: Fusionedge Test Hospital', time: 'Sep 29, 2025 05:38' },
    ];

    return (
        <header className="bg-[var(--header-bg)] backdrop-blur-md border-b border-[var(--border-color)] sticky top-0 z-40 md:px-8 px-2 py-2 flex items-center justify-between shadow-sm transition-colors duration-300">
            <div className="flex items-center gap-4">
                <button
                    onClick={onMenuClick}
                    className="p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-[var(--dashboard-text)]"
                >
                    <Menu className="w-6 h-6" />
                </button>
                <div className="relative hidden md:block">
                    <Search className="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-[var(--dashboard-text-light)]" />
                    <input
                        type="text"
                        placeholder="Search patients, appointments..."
                        className="pl-10 pr-4 py-2 w-64 bg-[var(--dashboard-secondary)] border-none rounded-full text-[var(--dashboard-text)] focus:ring-2 focus:ring-[var(--dashboard-primary)]/20 focus:bg-[var(--card-bg)] transition-all outline-none"
                    />
                </div>
            </div>

            <div className={`md:hidden flex items-center`}>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 862 638" fill="none" stroke="currentColor" className="h-8 w-8 min-w-[32px]"><path fill="currentColor" d="M395.46 604c12.62-7.7 25.24-15.37 37.84-23.09 2.27-1.39 4.3-3.19 6.64-4.41 5.29-2.77 8.64-1.87 11.98 3 .93 1.37 1.6 2.92 2.5 4.32 13.31 20.78 30.51 36.97 54.49 44.52 20.31 6.4 40.15 2.84 59.62-4.29 34.46-12.63 60.8-34.1 74.25-69.15 12-31.27 13.13-63.84 8.88-96.51-8.39-64.55-38.76-117.19-88.9-158.39-38.7-31.8-83.41-50.45-132.56-58.8a293.03 293.03 0 0 0-27.37-3.51c11.38 8.35 23.03 15.64 34.59 23.06 33.76 21.68 63.95 47.36 88.29 79.5 22.55 29.78 35.58 62.6 32.31 100.7-1.52 17.64-6.85 33.6-19.84 46.17-15.93 15.42-38.49 19.55-57.86 2.68-16.84-14.66-27.49-14.29-44.53-.11-1.92 1.6-3.7 3.4-5.77 4.78-4.28 2.85-8.46 6.03-13.11 8.09-24.14 10.67-53.09-3.94-57.39-29.87-1.84-11.11-1.38-23-0.2-34.2 2.73-19.41 13.11-35.7 24.55-51.22 2.53-3.43 5.12-6.81 7.68-10.22l-0.33-.44c-4.12-.18-8.29-.84-12.35-.41-5.1.54-10.15 1.8-15.15 3.02-53.58 13.14-90.03 44.3-103.59 99.17-8.53 34.48-5.11 67.12 18.19 95.28 30.64 37.04 71.37 51.48 116.76 31.48zm94.89-441c1.57 16.5 6.39 31.89 15.66 45.77 25.17 37.67 70.76 36.83 94.44-1.76 8.44-13.75 12.74-28.81 13.98-44.81 1.93-25-3.3-48.07-19.08-68-23.23-29.29-61.44-29.42-84.94-.41-16.13 19.92-21.26 43.2-20.05 69.19zm-116.86 65.07c16.33-2.67 28.36-11.9 37.49-25.14 14.97-21.69 18.27-46.08 15.46-71.6-1.68-15.27-6.48-29.58-15.46-42.22-10.71-15.07-24.81-24.63-43.78-25.05-21.72-.49-37.52 10.14-48.62 28.03-13.05 21.02-15.52 44.36-13 68.37 1.83 17.38 7.66 33.46 18.95 47.04 12.43 14.97 27.9 23.48 48.96 20.57zm321.45 139.7c3.32-.09 6.68.14 9.96-.31 19.2-2.62 32.42-13.96 41.83-30.04 13.6-23.25 15.72-48.39 10.7-74.37-3.54-18.34-10.63-35.08-24.35-48.23-11.22-10.76-24.45-16.56-40.39-14.08-18.46 2.87-31.2 14.04-39.73 29.69-18.94 34.75-19.26 70.4-1.74 105.72 8.65 17.44 22.81 28.83 43.72 31.63zm-437.8-48.21c1.3-3.59 2.78-7.13 3.88-10.78 4.85-16.2 3.51-32.64 1.36-49.01-2-15.22-7.08-29.32-16.32-41.83-20.08-27.19-66.77-32.82-87.93 4.54-4.24 7.47-7.85 15.48-10.44 23.65-11.03 34.86-7.17 67.47 16.78 96.2 20.41 24.48 53.37 25.92 75.33 2.91 6.87-7.2 11.45-16.59 17.34-25.68z"></path><path className="dark:fill-white fill-[#471480]" d="M395.1 604.11c-45.02 19.87-85.76 5.44-116.4-31.6-23.3-28.15-26.71-60.8-18.19-95.28 13.57-54.87 50.01-86.03 103.59-99.17 5-1.23 10.05-2.49 15.15-3.02 4.06-.43 8.23.23 12.35.41.11.53.22 1.06.33 1.6-2.56 3.4-5.15 6.79-7.68 10.21-11.44 15.52-21.82 31.81-24.55 51.22-1.58 11.22-2.04 23.09-.2 34.2 4.3 25.93 33.25 40.54 57.39 29.87 4.66-2.06 8.84-5.24 13.11-8.09 2.07-1.38 3.85-3.18 5.77-4.78 17.04-14.18 27.69-14.55 44.53.11 19.37 16.87 41.93 12.74 57.86-2.68 13-12.58 18.32-28.54 19.84-46.18 3.28-38.1-9.76-70.92-32.31-100.7-24.34-32.14-54.52-57.82-88.29-79.5-11.56-7.42-23.21-14.71-34.59-23.06 9.13 1.15 18.31 1.97 27.37 3.51 49.15 8.36 93.86 27 132.56 58.8 50.14 41.2 80.51 93.84 88.9 158.39 4.25 32.67 3.12 65.24-8.88 96.51-13.45 35.05-39.8 56.52-74.25 69.15-19.46 7.13-39.3 10.68-59.62 4.29-24-7.55-41.19-23.74-54.49-44.52-.9-1.4-1.56-2.95-2.5-4.32-3.34-4.87-6.68-5.77-12-3-2.34 1.23-4.37 3.03-6.64 4.41-12.6 7.72-25.22 15.39-38.2 23.2z"></path><path className="dark:fill-white fill-[#F73892]" d="M490.3 162.55c-1.16-25.53 3.96-48.81 20.1-68.73 23.5-29 61.71-28.88 84.94.42 15.78 19.9 21.02 43 19.08 67.97-1.24 16-5.54 31.06-13.98 44.81-23.67 38.59-69.27 39.43-94.44 1.76-9.27-13.87-14.08-28.86-15.7-46.23zm-117.25 65.58c-20.63 2.86-36.1-5.65-48.53-20.62-11.28-13.59-17.12-29.67-18.95-47.04-2.52-24.01-.05-47.35 13-68.38 11.1-17.89 26.9-28.52 48.62-28.03 19 .43 33.1 10 43.78 25.06 9 12.64 13.78 26.94 15.46 42.21 2.81 25.52-.47 49.91-15.46 71.6-9.13 13.24-21.17 22.47-37.92 25.2zm321.44 139.59c-20.47-2.74-34.63-14.13-43.28-31.58-17.52-35.31-17.2-70.96 1.74-105.72 8.53-15.65 21.27-26.82 39.73-29.69 15.94-2.48 29.17 3.33 40.39 14.08 13.72 13.16 20.8 29.9 24.35 48.24 5.02 25.98 2.9 51.12-10.7 74.37-9.41 16.08-22.62 27.42-41.83 30.04-3.27.45-6.64.22-10.4.26zm-437.49-47.8c-5.76 8.74-10.34 18.13-17.21 25.33-21.96 23.01-54.92 21.57-75.33-2.91-23.96-28.73-27.82-61.34-16.78-96.2 2.59-8.18 6.2-16.18 10.44-23.65 21.17-37.36 67.85-31.73 87.94-4.54 9.24 12.51 14.31 26.61 16.32 41.83 2.15 16.37 3.5 32.81-1.36 49.01-1.1 3.65-2.57 7.19-4.01 11.13z"></path></svg>
                <h1 className="text-lg font-semibold text-[var(--dashboard-primary)] px-2 whitespace-nowrap overflow-hidden transition-all duration-300">
                    AtelierVet
                </h1>
            </div>
            <div className="flex items-center gap-2">
                {/* POS Button - Reddish Pink */}
                <button
                    onClick={() => navigate('/pos')}
                    className="hidden sm:flex items-center gap-2 px-3 py-1.5 bg-[#F43F5E] hover:bg-[#E11D48] text-white rounded-lg shadow-sm transition-all duration-200 font-semibold"
                >
                    <Store className="w-4 h-4" />
                    <span>POS</span>
                </button>

                {/* Theme Toggle */}
                <button
                    onClick={toggleTheme}
                    className="p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-md transition-colors text-[var(--dashboard-text-light)]"
                >
                    {theme === 'dark' ? <Sun className="w-5 h-5" /> : <Moon className="w-5 h-5" />}
                </button>

                {/* Notification Dropdown */}
                <DropdownMenu>
                    <DropdownMenuTrigger asChild>
                        <button className="relative p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-md transition-colors outline-none">
                            <Bell className="w-6 h-6 text-[var(--dashboard-text-light)]" />
                            <span className="absolute top-1.5 right-1.5 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white dark:border-slate-800"></span>
                        </button>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent align="end" className="w-80 bg-[var(--card-bg)] border-[var(--border-color)]">
                        <div className="p-4 border-b border-[var(--border-color)] flex items-center gap-2">
                            <Bell className="w-4 h-4 text-[var(--dashboard-text)]" />
                            <h3 className="font-semibold text-[var(--dashboard-text)]">Notifications</h3>
                        </div>
                        <div className="max-h-[300px] overflow-y-auto">
                            {notifications.map((notif) => (
                                <DropdownMenuItem key={notif.id} className="p-4 border-b border-[var(--border-color)] hover:bg-[var(--dashboard-secondary)] cursor-pointer block">
                                    <p className="text-sm font-medium text-[var(--dashboard-text)] mb-1">{notif.title}</p>
                                    <p className="text-xs text-[var(--dashboard-text-light)]">{notif.time}</p>
                                </DropdownMenuItem>
                            ))}
                        </div>
                        <div className="p-3 bg-[var(--dashboard-secondary)] border-t border-[var(--border-color)] flex justify-between">
                            <button className="text-sm font-medium text-[var(--dashboard-primary)] hover:underline">View All</button>
                            <button className="text-sm font-medium text-[var(--dashboard-primary)] hover:underline">Mark All as Read</button>
                        </div>
                    </DropdownMenuContent>
                </DropdownMenu>

                {/* User Dropdown */}
                <div className="pl-6 border-l border-[var(--border-color)]">
                    <DropdownMenu>
                        <DropdownMenuTrigger asChild>
                            <button className="flex items-center gap-3 group focus:outline-none">
                                <div className="text-right hidden sm:block">
                                    <p className="text-sm font-semibold text-[var(--dashboard-text)]">Dr.Saranesh</p>
                                    <p className="text-xs text-[var(--dashboard-text-light)]">Admin</p>
                                </div>
                                <div className="w-10 h-10 rounded-full bg-gradient-to-tr from-[var(--dashboard-primary)] to-fuchsia-500 flex items-center justify-center text-white font-bold shadow-lg shadow-[var(--dashboard-primary)]/20 ring-2 ring-transparent group-hover:ring-[var(--dashboard-primary)]/20 transition-all">
                                    DS
                                </div>
                            </button>
                        </DropdownMenuTrigger>
                        <DropdownMenuContent align="end" className="w-60 bg-[var(--card-bg)] border-[var(--border-color)]">
                            <div className="p-4 border-b border-[var(--border-color)]">
                                <p className="font-semibold text-[var(--dashboard-text)]">Dr.Saranesh</p>
                                <p className="text-xs text-[var(--dashboard-text-light)]">admin@ateliervet.com</p>
                            </div>
                            <div className="p-2">
                                <DropdownMenuItem onClick={() => navigate('/')} className="cursor-pointer gap-3 text-[var(--dashboard-text)] focus:bg-[var(--dashboard-secondary)]">
                                    <LayoutDashboard className="w-4 h-4" />
                                    Dashboard
                                </DropdownMenuItem>
                                <DropdownMenuItem className="cursor-pointer gap-3 text-[var(--dashboard-text)] focus:bg-[var(--dashboard-secondary)]">
                                    <User className="w-4 h-4" />
                                    Profile
                                </DropdownMenuItem>
                                <DropdownMenuItem className="cursor-pointer gap-3 text-[var(--dashboard-text)] focus:bg-[var(--dashboard-secondary)]" onClick={() => navigate('/settings')}>
                                    <Settings className="w-4 h-4" />
                                    Settings
                                </DropdownMenuItem>
                                <DropdownMenuSeparator className="bg-[var(--border-color)]" />
                                <DropdownMenuItem onClick={() => navigate('/login')} className="cursor-pointer gap-3 text-red-500 focus:bg-red-50 dark:focus:bg-red-900/10">
                                    <LogOut className="w-4 h-4" />
                                    Log out
                                </DropdownMenuItem>
                            </div>
                        </DropdownMenuContent>
                    </DropdownMenu>
                </div>
            </div>
        </header>
    );
};

export default Header;
